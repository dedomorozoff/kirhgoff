# Техническая документация: Интерактивный стенд "Законы Кирхгофа"

## 1. Стек технологий

Проект реализован на чистом стеке веб-технологий без использования фреймворков и внешних зависимостей (Vanilla JS).

*   **HTML5**: Семантическая разметка, использование тега `<canvas>` для графики.
*   **CSS3**:
    *   Использование CSS Variables (Custom Properties) для темизации.
    *   Flexbox для компоновки интерфейса.
    *   Встроенные SVG-иконки (Data URI) для минимизации запросов.
*   **JavaScript (ES6+)**:
    *   Модульная структура (классы).
    *   Отсутствие сборщиков (Webpack/Vite не требуются).

## 2. Архитектура приложения

Приложение построено по принципу **State-Driven Rendering** (отрисовка на основе состояния).

### 2.1. Состояние (`state`)
Глобальный объект `state` хранит всю информацию о текущей схеме:
*   `components`: Массив объектов `Component` (резисторы, источники ЭДС).
*   `wires`: Массив объектов `Wire` (соединительные провода).
*   `mode`: Текущий режим работы ('select', 'wire').
*   `view`: Параметры отображения (смещение `x`, `y` и масштаб `scale`).
*   `simulationResult`: Результаты последнего расчета (потенциалы узлов, токи).

### 2.2. Основной цикл (`loop`)
Используется `requestAnimationFrame` для непрерывной перерисовки холста. Функция `draw()` очищает холст и последовательно отрисовывает:
1.  Сетку.
2.  Провода.
3.  Компоненты.
4.  Визуализацию симуляции (если активна).
5.  Интерфейсные элементы (выделение, временные линии).

## 3. Ключевые алгоритмы

### 3.1. Симуляция цепи (MNA)
Для расчета токов и напряжений используется **Метод Узловых Потенциалов (Modified Nodal Analysis - MNA)**.

*   **Класс `CircuitSolver`**:
    1.  **Поиск узлов**: Обход графа (BFS) для объединения соединенных клемм компонентов в электрические узлы.
    2.  **Формирование матрицы**: Составляется система линейных уравнений `Ax = b`, где `A` — матрица проводимостей и связей источников ЭДС, `b` — вектор источников тока/напряжения.
    3.  **Решение СЛАУ**: Используется метод Гаусса (класс `LinearAlgebra`) для нахождения потенциалов узлов и токов через источники ЭДС.

### 3.2. Отрисовка проводов
Провода поддерживают произвольное количество точек изгиба (waypoints).
*   **Интерактивное создание**: Пользователь задает начальную точку, промежуточные углы и конечную точку.
*   **Рендеринг**: Используется `CanvasRenderingContext2D.lineTo` для рисования ломаных линий.

### 3.3. Навигация (Zoom & Pan)
*   **Масштабирование**: Изменение `state.view.scale` с коррекцией смещения, чтобы зум происходил относительно позиции курсора мыши.
*   **Панорамирование**: Изменение `state.view.x` и `state.view.y` при перетаскивании холста.
*   **Преобразование координат**: Функции `getMousePos` и `ctx.transform` обеспечивают связь между экранными координатами и мировыми координатами схемы.

## 4. Структура файлов

*   `index.html`: Каркас приложения, верстка панелей инструментов.
*   `style.css`: Стили интерфейса, иконки.
*   `script.js`: Вся логика приложения (классы, обработчики событий, математическое ядро).
