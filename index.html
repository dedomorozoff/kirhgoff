<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Å—Ç–µ–Ω–¥: –ó–∞–∫–æ–Ω—ã –ö–∏—Ä—Ö–≥–æ—Ñ–∞</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>
</head>

<body>
    <div class="app-container">
        <header class="app-header">
            <h1>–ó–∞–∫–æ–Ω—ã –ö–∏—Ä—Ö–≥–æ—Ñ–∞</h1>
            <div class="controls">
                <button id="btn-undo" class="btn secondary btn-icon" title="–û—Ç–º–µ–Ω–∏—Ç—å (Ctrl+Z)" disabled>
                    <i data-lucide="undo"></i>
                </button>
                <button id="btn-redo" class="btn secondary btn-icon" title="–ü–æ–≤—Ç–æ—Ä–∏—Ç—å (Ctrl+Y)" disabled>
                    <i data-lucide="redo"></i>
                </button>
                <div style="width: 1px; height: 30px; background: var(--border-color); margin: 0 0.5rem;"></div>
                <button id="btn-zoom-in" class="btn secondary btn-icon" title="–£–≤–µ–ª–∏—á–∏—Ç—å">
                    <i data-lucide="zoom-in"></i>
                </button>
                <button id="btn-zoom-out" class="btn secondary btn-icon" title="–£–º–µ–Ω—å—à–∏—Ç—å">
                    <i data-lucide="zoom-out"></i>
                </button>
                <button id="btn-zoom-reset" class="btn secondary btn-icon" title="–°–±—Ä–æ—Å–∏—Ç—å –º–∞—Å—à—Ç–∞–±">
                    <i data-lucide="maximize"></i>
                </button>
                <div style="width: 1px; height: 30px; background: var(--border-color); margin: 0 0.5rem;"></div>
                <button id="btn-run" class="btn primary">
                    <i data-lucide="play"></i>
                    <span>–ó–∞–ø—É—Å—Ç–∏—Ç—å</span>
                </button>
                <button id="btn-stop" class="btn secondary" disabled>
                    <i data-lucide="square"></i>
                    <span>–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</span>
                </button>
                <button id="btn-show-equations" class="btn secondary" disabled title="–ü–æ–∫–∞–∑–∞—Ç—å —É—Ä–∞–≤–Ω–µ–Ω–∏—è">
                    <i data-lucide="sigma"></i>
                    <span>–£—Ä–∞–≤–Ω–µ–Ω–∏—è</span>
                </button>
                <button id="btn-clear-loop" class="btn secondary" disabled>
                    <i data-lucide="eraser"></i>
                    <span>–û—á–∏—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç—É—Ä</span>
                </button>
                <button id="btn-save" class="btn secondary">
                    <i data-lucide="save"></i>
                    <span>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</span>
                </button>
                <button id="btn-load" class="btn secondary">
                    <i data-lucide="folder-open"></i>
                    <span>–ó–∞–≥—Ä—É–∑–∏—Ç—å</span>
                </button>
                <button id="btn-examples" class="btn secondary">
                    <i data-lucide="book-open"></i>
                    <span>–ü—Ä–∏–º–µ—Ä—ã</span>
                </button>
                <button id="btn-clear" class="btn danger">
                    <i data-lucide="trash-2"></i>
                    <span>–û—á–∏—Å—Ç–∏—Ç—å</span>
                </button>
            </div>
            <input type="file" id="file-input" accept=".json" style="display: none;">
        </header>

        <main class="main-content">
            <aside class="sidebar">
                <div class="component-palette">
                    <h3>–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã</h3>
                    <div class="palette-item" draggable="true" data-type="resistor" title="R - –†–µ–∑–∏—Å—Ç–æ—Ä">
                        <div class="icon resistor-icon"></div>
                    </div>
                    <div class="palette-item" draggable="true" data-type="voltage" title="E - –ò—Å—Ç–æ—á–Ω–∏–∫ –≠–î–°">
                        <div class="icon voltage-icon"></div>
                    </div>
                    <div class="palette-item" draggable="true" data-type="current" title="J - –ò—Å—Ç–æ—á–Ω–∏–∫ —Ç–æ–∫–∞">
                        <div class="icon current-icon"></div>
                    </div>
                    <div class="palette-item" draggable="true" data-type="ammeter" title="PA - –ê–º–ø–µ—Ä–º–µ—Ç—Ä">
                        <div class="icon ammeter-icon"></div>
                    </div>
                    <div class="palette-item" draggable="true" data-type="voltmeter" title="PV - –í–æ–ª—å—Ç–º–µ—Ç—Ä">
                        <div class="icon voltmeter-icon"></div>
                    </div>
                    <div class="palette-item" draggable="true" data-type="junction" title="–£–∑–µ–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è">
                        <div class="icon junction-icon"></div>
                    </div>
                    <!-- Wire is drawn, not dragged, but maybe a mode toggle? -->
                    <div class="palette-item" id="mode-wire" title="–ü—Ä–æ–≤–æ–¥ (–∫–ª–∞–≤–∏—à–∞ W)">
                        <div class="icon wire-icon"></div>
                    </div>
                </div>
            </aside>

            <div class="canvas-container">
                <canvas id="circuit-canvas"></canvas>
                <div class="overlay-info" id="overlay-info"></div>
            </div>
        </main>

        <!-- Bottom Panel -->
        <div class="bottom-panel" id="bottom-panel">
            <div class="bottom-panel-section" id="component-props" style="display: none;">
                <strong id="comp-type-label">–ö–æ–º–ø–æ–Ω–µ–Ω—Ç:</strong>
                <label id="resistance-input" style="display: none;">
                    R (–û–º): <input type="number" id="prop-resistance" min="0.1" step="10" value="100">
                </label>
                <label id="voltage-input" style="display: none;">
                    E (–í): <input type="number" id="prop-voltage" step="1" value="5">
                </label>
                <label id="current-input" style="display: none;">
                    J (–ê): <input type="number" id="prop-current" min="0.001" step="0.01" value="0.1">
                </label>
                <div id="meter-reading" style="display: none;">
                    <strong>–ü–æ–∫–∞–∑–∞–Ω–∏—è:</strong> <span id="meter-value" style="color: #0369a1; font-size: 1.1em;">-</span>
                </div>
                <button id="btn-delete-comp" class="btn danger small">–£–¥–∞–ª–∏—Ç—å</button>
            </div>
            <div class="bottom-panel-divider" id="divider-1" style="display: none;"></div>
            <div class="bottom-panel-section">
                <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                    <input type="checkbox" id="auto-route" checked style="cursor: pointer;">
                    <span>–ê–≤—Ç–æ—Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞</span>
                </label>
            </div>
            <div class="bottom-panel-divider"></div>
            <div class="bottom-panel-info" id="help-text">
                <strong>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:</strong> –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–π—Ç–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã ‚Ä¢ <strong>W</strong> - –ø—Ä–æ–≤–æ–¥ ‚Ä¢ <strong>R</strong> - –ø–æ–≤–æ—Ä–æ—Ç ‚Ä¢ <strong>Del</strong> - —É–¥–∞–ª–∏—Ç—å ‚Ä¢ <strong>–ö–æ–ª–µ—Å–∏–∫–æ</strong> - –∑—É–º ‚Ä¢ <strong>–°—Ä–µ–¥–Ω—è—è –∫–Ω–æ–ø–∫–∞</strong> - –ø–∞–Ω–æ—Ä–∞–º–∞
            </div>
        </div>
    </div>

    <!-- Error Modal -->
    <div id="error-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚ö† –û—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</h3>
                <button class="modal-close" id="modal-close">&times;</button>
            </div>
            <div class="modal-body" id="error-list"></div>
            <div class="modal-footer">
                <button class="btn primary" id="modal-ok">–ü–æ–Ω—è—Ç–Ω–æ</button>
            </div>
        </div>
    </div>

    <!-- Examples Modal -->
    <div id="examples-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üìö –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ø—Ä–∏–º–µ—Ä–æ–≤</h3>
                <button class="modal-close" id="examples-close">&times;</button>
            </div>
            <div class="modal-body" id="examples-list"></div>
        </div>
    </div>

    <!-- Equations Modal -->
    <div id="equations-modal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h3>üìê –£—Ä–∞–≤–Ω–µ–Ω–∏—è —Ü–µ–ø–∏</h3>
                <button class="modal-close" id="equations-close">&times;</button>
            </div>
            <div style="display: flex; gap: 0.5rem; padding: 0 20px; border-bottom: 1px solid var(--border-color);">
                <button class="tab-btn active" data-tab="mna">MNA</button>
                <button class="tab-btn" data-tab="kcl">1-–π –∑–∞–∫–æ–Ω (KCL)</button>
                <button class="tab-btn" data-tab="kvl">2-–π –∑–∞–∫–æ–Ω (KVL)</button>
            </div>
            <div class="modal-body" style="font-family: 'Courier New', monospace; font-size: 0.9em;">
                <div id="tab-mna" class="tab-content active"></div>
                <div id="tab-kcl" class="tab-content" style="display: none;"></div>
                <div id="tab-kvl" class="tab-content" style="display: none;"></div>
            </div>
            <div class="modal-footer">
                <button class="btn secondary" id="equations-ok">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <script src="examples.js"></script>
    <script src="script.js"></script>
    <script>
        // Initialize Lucide icons
        lucide.createIcons();
    </script>
</body>

</html>